# ソリューション概要 — TaxViz（タックスビズ）

## プロダクトコンセプト

**「確定申告を、リアルタイムダッシュボードに変える」**

TaxVizは、確定申告の入力画面そのものをインタラクティブなダッシュボードにします。左側に入力フォーム、右側にリアルタイムで更新される税額サマリー・フローチャートを常時表示。1つの数値を入力するたびに、その影響が即座に全体に反映されます。

## コア機能

### 1. リアルタイム税額ダッシュボード

```
┌─────────────────────┬──────────────────────────┐
│                     │  💰 リアルタイムサマリー    │
│  📝 入力フォーム     │                          │
│                     │  収入合計:    ¥8,500,000  │
│  医療費控除         │  所得控除:    ¥1,230,000  │
│  ┌───────────┐     │  課税所得:    ¥5,270,000  │
│  │ ¥ 120,000 │←──│──→ 所得税:    ¥  532,500  │
│  └───────────┘     │  住民税:      ¥  527,000  │
│  ↑ 入力した瞬間に   │  ───────────────────────  │
│    右側が更新        │  還付額:    ▲¥  85,000  │
│                     │  (この入力で +¥12,000↑)  │
│                     │                          │
│                     │  📊 控除内訳グラフ         │
│                     │  ████████ 基礎控除 48万   │
│                     │  ████ 社保控除 35万       │
│                     │  ██ 医療費控除 12万 ←NEW  │
└─────────────────────┴──────────────────────────┘
```

### 2. タックスフローマップ

収入→経費→各種控除→課税所得→税額→還付/納付のフローをサンキーダイアグラムで可視化。各ノードをクリックすると該当入力セクションにジャンプ。

### 3. インパクトインジケーター

各入力項目の横に「この入力による節税効果」をリアルタイム表示:
- 🟢 **+¥12,000** — 医療費控除の入力で12,000円の節税
- 🔴 **-¥0** — この項目は控除対象外（理由を表示）
- 🟡 **+¥50,000（推定）** — まだ入力途中、完了すると約5万円の節税見込み

### 4. スマート入力ガイド

- **優先度順の入力提案:** 「次にふるさと納税を入力すると、さらに¥30,000の控除が見込めます」
- **入力漏れアラート:** 「医療費が10万円を超えています。医療費控除の申請をお忘れなく」
- **用語のインライン解説:** 専門用語にカーソルを合わせると、自分の数値に基づいた具体的な説明がポップアップ

### 5. AIアドバイザー

- 入力データに基づくパーソナライズされた節税提案
- 「あなたの場合、iDeCoに年間27.6万円拠出すると約5.5万円の節税になります」
- 過去の申告データとの比較分析

## 画面設計

### メイン画面構成

| 画面 | 説明 |
|------|------|
| **ダッシュボード** | 全体サマリー + 進捗マップ + 重要指標 |
| **収入入力** | 給与・事業・不動産・雑所得の入力 |
| **経費入力** | カテゴリ別経費入力 + レシートOCR |
| **控除入力** | 所得控除14種類 + 税額控除 |
| **確認・提出** | 最終確認 + e-Tax連携 + PDF出力 |

### レスポンシブ対応

- **デスクトップ:** 2カラム（入力 + ダッシュボード並列表示）
- **タブレット:** 入力メイン + 下部にミニダッシュボード
- **スマホ:** 入力画面 + フローティングサマリーバー

## 技術スタック

### フロントエンド

| 技術 | 用途 |
|------|------|
| **Next.js 15** | フレームワーク（App Router） |
| **React 19** | UIコンポーネント |
| **TypeScript** | 型安全性 |
| **Recharts / D3.js** | グラフ・チャート描画 |
| **Framer Motion** | アニメーション（数値変化のトランジション） |
| **TailwindCSS** | スタイリング |

### バックエンド

| 技術 | 用途 |
|------|------|
| **Supabase** | 認証・データベース・リアルタイム同期 |
| **Edge Functions** | 税額計算ロジック（低レイテンシ） |
| **OpenAI API** | AI節税アドバイス |
| **Tesseract.js** | レシートOCR |

### インフラ

| 技術 | 用途 |
|------|------|
| **Vercel** | ホスティング・Edge Runtime |
| **Supabase** | マネージドDB・認証 |
| **Cloudflare R2** | ファイルストレージ（レシート画像） |

## MVP定義（Phase 1 — 3ヶ月）

### 含むもの
- ✅ 給与所得の入力
- ✅ 主要な所得控除（医療費・ふるさと納税・社会保険料・生命保険料）
- ✅ リアルタイム税額ダッシュボード
- ✅ タックスフローマップ（簡易版）
- ✅ インパクトインジケーター
- ✅ PDF出力

### 含まないもの（Phase 2以降）
- ❌ 事業所得・不動産所得
- ❌ e-Tax直接連携
- ❌ AIアドバイザー
- ❌ レシートOCR
- ❌ 税理士マッチング

## 開発ロードマップ

| Phase | 期間 | 内容 |
|-------|------|------|
| **Phase 1** | 3ヶ月 | MVP（給与所得 + リアルタイムダッシュボード） |
| **Phase 2** | 3ヶ月 | 事業所得対応 + AIアドバイザー |
| **Phase 3** | 3ヶ月 | e-Tax連携 + レシートOCR |
| **Phase 4** | 3ヶ月 | 税理士プラットフォーム + API公開 |
