# RailFinder — ソリューション概要

## システムアーキテクチャ

### 全体構成

```
[RailFinder Tag (BLE)] 
        ↓ Bluetooth Low Energy (2.4GHz)
[Station Gateway (BLE Reader + LTE/WiFi)]
        ↓ HTTPS/MQTT
[AWS Cloud (Tokyo Region)]
        ↓ Push Notification / API
[User Smartphone App (iOS/Android)]
```

---

## ハードウェア設計

### RailFinder Tag（タグ本体）

| スペック | 値 |
|---------|-----|
| サイズ | 37mm × 37mm × 5mm（薄型カード型） |
| 重量 | 8g |
| 通信規格 | BLE 5.2（Bluetooth Low Energy） |
| 広告間隔 | 2秒〜30秒（省電力モード切替） |
| 電池寿命 | CR2032 × 1個、最大2年 |
| 防水 | IP67（水深1m・30分） |
| 素材 | 強化ポリカーボネート + ソフトTPUエッジ |
| カラー | ホワイト / ブラック / サクラ（季節限定） |

**設計思想**: 財布に入れても違和感ない薄型、カバンのファスナーに付けやすいリング穴付き。

### Station Gateway（駅設置型BLEリーダー）

| スペック | 値 |
|---------|-----|
| 検出範囲 | 半径10〜15m（改札・コンコース対応） |
| 同時検出数 | 最大500タグ/秒 |
| 通信 | LTE Cat-M1（SIM内蔵）+ WiFi 5GHz |
| 電源 | 駅既存AC100V引き込み |
| 設置場所 | 改札上部・ホーム柱・コンコース天井 |
| 耐環境 | IP54（防塵・防滴） |
| サイズ | 150mm × 80mm × 40mm（薄型BOX） |

---

## ソフトウェアスタック

### バックエンド
```yaml
言語: Go (gRPC API) + Node.js (Webhook/通知)
インフラ: AWS (ECS Fargate + RDS Aurora + DynamoDB)
メッセージング: AWS IoT Core (MQTT) + SQS
通知: FCM (Android) + APNs (iOS)
DB: 
  - RDS Aurora MySQL: ユーザー・タグ・サブスク管理
  - DynamoDB: 検出ログ（高頻度書き込み）
  - ElastiCache Redis: リアルタイムセッション
地図: Google Maps Platform + 国土地理院タイル
```

### モバイルアプリ（React Native）
```yaml
対応OS: iOS 15+ / Android 10+
主要画面:
  - ダッシュボード: 全タグの現在状態一覧
  - 地図画面: 最終検出駅をマップ表示
  - 履歴画面: 過去30日の移動ログ
  - 設定画面: アラート設定・サブスク管理
オフライン: タグ登録情報をローカルキャッシュ
```

---

## ユーザーフロー

### 1. セットアップ（初回・3分）
1. アプリDL → メール登録
2. タグの電池タブを引く
3. アプリで「タグ追加」→ スマホとペアリング（Bluetooth）
4. タグに名前とアイコンを設定（例：「仕事カバン」「財布」）
5. 完了 — 次回から自動で保護開始

### 2. 通常利用（ユーザー操作なし）
- タグが駅ゲートウェイを通過 → 自動でクラウドに記録
- アプリを開けば「最終確認場所: 渋谷駅 14:32」と表示

### 3. 紛失時のフロー
1. アプリで「このタグを紛失した」をタップ
2. 最終検出駅・時刻が即表示
3. 「次にゲートウェイを通過したら通知する」ONに
4. 誰かがタグを持って電車に乗れば → 「新宿駅で検出」通知
5. Premium: 自動で鉄道会社遺失物センターに届出

---

## MVP（最小限のプロダクト）

### Phase 1（6ヶ月）: 試験運用
- 対象: 山手線 + 中央線 + 東海道線（JR東日本3路線・150駅）
- ゲートウェイ: 150台設置（各改札に1台）
- アプリ: iOS先行（Android後追い）
- ユーザー: モニター500名

### Phase 2（12ヶ月）: 正式ローンチ
- 対象: JR東日本全路線 + 東急・小田急・西武
- ゲートウェイ: 1,500台
- アプリ: iOS/Android同時

### Phase 3（24ヶ月）: 全国展開
- 全主要鉄道会社連携
- 遺失物センターAPI本格統合
- 保険商品連携開始

---

## 技術的優位性

1. **省電力BLEプロトコル最適化**: タグの電池が2年持つ独自ペイロード設計
2. **大量タグ同時処理**: ゲートウェイ1台あたり500タグ/秒の高スループット
3. **フォールバック機能**: スマホ間Bluetooth中継（Crowd Network）もサポート
4. **プライバシー設計**: タグIDは暗号化ローリング方式（追跡不可能）

---

## データプライバシー設計

- タグIDは7日ごとに自動ローテーション（本人しか紐付け不可）
- 位置ログは本人のみ閲覧可（鉄道会社にも開示しない）
- GDPR / 個人情報保護法完全準拠
- SOC2 Type II認証取得予定（Year 2）
