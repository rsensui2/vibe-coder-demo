# リスク分析 — KaFun Shield

## リスクマトリクス

| # | リスク | 発生確率 | 影響度 | 総合リスク | 対策 |
|---|--------|---------|--------|-----------|------|
| 1 | 花粉データの取得障害 | 中 | 高 | 🔴 高 | 複数データソース冗長化 |
| 2 | シーズン外のユーザー離脱 | 高 | 高 | 🔴 高 | 通年機能の追加 |
| 3 | 競合サービスの参入 | 中 | 中 | 🟡 中 | データ蓄積による差別化 |
| 4 | 個人情報漏洩 | 低 | 高 | 🟡 中 | セキュリティ設計の徹底 |
| 5 | 予測精度の低さ | 中 | 高 | 🔴 高 | 段階的精度向上+透明性 |
| 6 | 地図APIのコスト増 | 中 | 中 | 🟡 中 | キャッシュ最適化+代替API |
| 7 | 花粉の少ない年の需要減 | 低 | 中 | 🟢 低 | 環境リスク全般への拡張 |
| 8 | 規制・ガイドライン変更 | 低 | 中 | 🟢 低 | 法務チェック体制の構築 |

## 詳細分析

### リスク1: 花粉データの取得障害

**シナリオ**: 環境省「はなこさん」のAPIがダウン、または仕様変更でデータ取得不能

**影響**: ヒートマップの更新停止→ユーザー信頼の喪失

**対策**:
1. **プライマリ**: 環境省花粉観測システム（はなこさん）
2. **セカンダリ**: ウェザーニューズ花粉データ（有料バックアップ）
3. **ターシャリ**: 気象データ（風速・気温・湿度）からの推計モデル
4. **キャッシュ**: 直近24時間のデータをローカルキャッシュ、障害時は「推計値」とラベル表示
5. **ユーザー報告**: クラウドソーシングデータで補完

**発動基準**: プライマリソースが30分以上無応答

### リスク2: シーズン外のユーザー離脱

**シナリオ**: 花粉シーズン（2-5月）終了後にMAUが90%以上減少

**影響**: 年間を通じた収益安定化が困難、翌シーズンの再獲得コスト発生

**対策**:
1. **通年データの提供**: PM2.5（通年）、黄砂（3-5月）、紫外線（通年）、熱中症リスク（6-9月）
2. **花粉カレンダー**: オフシーズンでも翌年の予測・準備情報を配信
3. **症状日記**: 通年の体調管理ツールとしてのポジショニング
4. **秋花粉**: ブタクサ・ヨモギ（8-10月）、イネ科（5-10月）への対応で実質8ヶ月カバー

**KPI**: オフシーズンMAU維持率 > 20%

### リスク3: 競合サービスの参入

**シナリオ**: ウェザーニューズやYahoo!天気が同等機能をリリース

**影響**: ユーザー獲得競争の激化、差別化困難

**対策**:
1. **データモート**: 500mメッシュの独自データ蓄積は時間経過で再現困難
2. **パーソナライゼーション**: 個人の症状パターンAI学習は乗り換えコスト高
3. **コミュニティ**: 花粉症患者同士のQ&A・情報共有機能でロックイン
4. **先行者優位**: 2月のピーク前ローンチで初年度のデータ獲得

### リスク4: 個人情報漏洩

**シナリオ**: 位置情報・健康情報の漏洩

**影響**: 法的責任（個人情報保護法）、レピュテーション崩壊

**対策**:
1. **最小限の収集**: 位置情報はフロントエンドで処理、サーバーには集計済みメッシュIDのみ送信
2. **暗号化**: 全通信HTTPS、保存データAES-256暗号化
3. **認証**: Supabase AuthのRow Level Security（RLS）
4. **匿名化**: 分析用データは全て匿名化処理
5. **プライバシーポリシー**: 弁護士レビュー済みの明確な利用規約

### リスク5: 予測精度の低さ

**シナリオ**: ヒートマップの表示と実際の花粉飛散量に大きな乖離

**影響**: ユーザー信頼の喪失、「使えない」評価

**対策**:
1. **段階的精度向上**: MVP時点では環境省データをそのまま表示し、独自予測は明記
2. **信頼度表示**: 各メッシュに「信頼度」バッジ（データポイント数に基づく）
3. **ユーザーフィードバック**: 「この地点の花粉、実際どう？」で補正データ収集
4. **機械学習**: 3シーズン分のデータ蓄積後にモデル精度を大幅向上

### リスク6: 地図APIのコスト増

**シナリオ**: Mapboxの利用量増加でAPIコストが収益を圧迫

**影響**: MAU拡大がコスト増に直結する「スケールの不経済」

**対策**:
1. **タイルキャッシュ**: CDN + Redis で同一タイルの再リクエストを90%削減
2. **オフラインマップ**: 頻繁に閲覧するエリアをローカルキャッシュ
3. **代替API**: MapLibre GL JS（オープンソース）への段階的移行
4. **自前タイルサーバー**: MAU 50万人以上で自社タイルサーバー構築を検討

## コンティンジェンシープラン

### 最悪シナリオ: 花粉シーズンにサービスダウン

```
発生 → 15分以内: 障害検知（Uptime監視）
     → 30分以内: 静的キャッシュページへフォールバック
     → 1時間以内: 原因特定・復旧着手
     → 2時間以内: サービス復旧
     → 24時間以内: ポストモーテム・再発防止策
```

### シナリオ: データソース全停止

```
発生 → 即座: 「データ取得中に問題が発生しています」バナー表示
     → 直近キャッシュデータ + 気象推計モデルで表示（「推計」ラベル付き）
     → SNSで状況報告
     → 手動データ入力の緊急フロー起動（主要10都市のみ）
```
